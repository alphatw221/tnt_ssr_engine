<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>website_search_bar</title>
</head>
<body>
<h1>website_search_bar</h1>
<h2>src/components/component-instance/WebsiteSearchBar.jsx</h2>
<pre>import PropTypes from &quot;prop-types&quot;;
import React, { Fragment, useState, useEffect, useRef } from &quot;react&quot;;
import clsx from &quot;clsx&quot;;
import style from './WebsiteSearchBar.module.scss'

     
// import { useAppSelector } from &quot;@/redux/hooks&quot;;   



import {useClickOutsideEvent} from '../../lib/utils/clickOutside.js'

// import { getRWDStyles} from &quot;@/lib/utils/rwdHelper&quot;

// import { customer_search_product } from &quot;../../api/product&quot;;
// import { customer_search_blog_post } from &quot;../../api/blog_post&quot;;
import { customer_search_store_results } from &quot;../../api/estore&quot;
// import Link from &quot;next/link&quot;;
const WebsiteSearchBar = ({  

    // node,  mode, actions, update, children, routingTable, ...props

    routingTable,

    element, 
    elementProps,
    mode,
    ...props


}) =&gt; {

    // const websiteEditorState = useAppSelector((state) =&gt; state.website_editor);



    const [showDropDown, setShowDropDown] = useState(false)
    const [isFetching, setIsFetching] = useState(false)

    const [searchText, setSearchText] = useState('')
    const dropDown = useRef()


    useClickOutsideEvent(useEffect, dropDown,()=&gt;{
        setShowDropDown(false)
    },showDropDown)


    // const [searchBarFontSize, setSearchBarFontSize] = useState('')
    // const [searchBarLineHeight, setSearchBarLineHeight] = useState('')
    // const [resultTitleFontSize, setResultTitleFontSize] = useState('')
    // const [resultTitleLineHeight, setResultTitleLineHeight] = useState('')
    // const [resultParagraphFontSize, setResultParagraphFontSize] = useState('')
    // const [resultParagraphLineHeight, setResultParagraphLineHeight] = useState('')
    // const [width, setWidth] = useState('')
    // const [height, setHeight] = useState('')
    // const [dropdownWidth, setDropdownWidth] = useState('')



    const [results, setResults] = useState([])
    // const [resultsGotNext, setResultsGotNext] = useState(false)
    // const [page, setPage] = useState(1)
    // const [productResults, setProductResults] = useState([])

    const searchResults = ()=&gt;{
        setShowDropDown(true)
        setIsFetching(true)
        

        customer_search_store_results(searchText).then(res=&gt;{
            console.log(res.data)
            setIsFetching(false)
            setResults(res?.data||[])

        }).catch(err=&gt;{ setIsFetching(false) })
    }



    // useEffect(()=&gt;{

    //     rwdHelper(
    //         websiteEditorState.windowWidth, 
    //         websiteEditorState.sideMenuActive, 
    //         [

    //             new RWDPropHandler(node?.data, 'rwd_width', 'width_unit', setWidth),
    //             new RWDPropHandler(node?.data, 'rwd_height', 'height_unit', setHeight),

    //             new RWDPropHandler(node?.data, 'search_bar_rwd_line_height', 'px', setSearchBarLineHeight),
    //             new RWDPropHandler(node?.data, 'search_bar_rwd_font_size', 'px', setSearchBarFontSize),

    //             new RWDPropHandler(node?.data, 'dropdown_rwd_width', 'width_unit', setDropdownWidth),

    //             new RWDPropHandler(node?.data, 'reault_title_rwd_line_height', 'px', setResultTitleLineHeight),
    //             new RWDPropHandler(node?.data, 'reault_title_rwd_font_size', 'px', setResultTitleFontSize),

    //             new RWDPropHandler(node?.data, 'reault_paragraph_rwd_line_height', 'px', setResultParagraphLineHeight),
    //             new RWDPropHandler(node?.data, 'reault_paragraph_rwd_font_size', 'px', setResultParagraphFontSize),

    //         ]
    //     )



    // },[ websiteEditorState.windowWidth, websiteEditorState.sideMenuActive, 
    //     setWidth, 
    //     setHeight, 
    //     setSearchBarLineHeight, 
    //     setSearchBarFontSize,
    //     setDropdownWidth, 
    //     setResultTitleLineHeight,
    //     setResultTitleFontSize,
    //     setResultParagraphLineHeight,
    //     setResultParagraphFontSize,
    //     node?.data])


    const hightlight = (text, keyword, tag, className, length) =&gt;{

        const index = text.indexOf(keyword);

        const start = Math.max(0, index-length)
        const end = Math.min(text.length, index+length)

        const postfix = text.length&gt;index+length?'...':''
        text = text.slice(start, end)
        return text.replace(keyword, `&lt;${tag} class=&quot;${style[className]} ${className}&quot;&gt;${keyword}&lt;/${tag}&gt;`)+postfix


    }


    const { className, ...rest } = elementProps;
    return (
    
        
        &lt;div {...rest} className={clsx(style[&quot;站內搜尋框&quot;], &quot;站內搜尋框&quot;, className)} &gt;
            &lt;input  
                className={
                    clsx(style['搜尋-輸入'],'搜尋-輸入',)
                } 
                type='text'
                value={searchText}
                onChange={(e)=&gt;{setSearchText(e.target.value)}}
                placeholder={`搜尋${element?.data?.search_type||''}...`}
                
            /&gt;   
            &lt;button className={clsx(style['搜尋-按鈕'],'搜尋-按鈕',)} onClick={(e)=&gt;{searchResults()}}&gt;
                搜尋
            &lt;/button&gt;



            &lt;div className={clsx(style['搜尋結果-下拉'], '搜尋結果-下拉', showDropDown?style['顯示']:'', showDropDown?'顯示':'')}  ref={dropDown}&gt;   

                
                {

                    isFetching
                    ?
                    &lt;div className={clsx(style['旋轉器框'], '旋轉器框')}&gt;
                        &lt;i className={clsx(style['旋轉器'], '旋轉器')}  /&gt;
                    &lt;/div&gt;
                    :
                    &lt;Fragment&gt;
                        {
                            (results||[]).length&lt;=0
                            ?
                            &lt;div className={clsx(style['搜尋結果框'], '搜尋結果框')}&gt;
                                &lt;h3&gt;無符合結果&lt;/h3&gt;
                            &lt;/div&gt;
                            
                            :
                        (results||[]).map((result,i)=&gt;(

                            &lt;Fragment key={i}&gt;
                                { 
                                result?.name
                                ?
                                &lt;a  href={`/${routingTable?.['product_route']}/${result.uuid}`}&gt;
                                    &lt;div  className={clsx(style['搜尋結果框'], '搜尋結果框')} &gt;
                                        &lt;span className={clsx(style['搜尋結果-標題'], '搜尋結果框-標題')} dangerouslySetInnerHTML={{ __html: hightlight(result?.name, searchText, 'span', '高亮', 125) }}&gt;&lt;/span&gt;
                                        &lt;br /&gt;
                                        &lt;p className={clsx(style['搜尋結果-敘述'], '搜尋結果-敘述')} dangerouslySetInnerHTML={{ __html: hightlight(result?.description, searchText, 'span', '高亮', 125) }}&gt;&lt;/p&gt;
                                    &lt;/div&gt;
                                &lt;/a&gt;
                                :
                                &lt;a  href={`/${routingTable?.['blog_post_route']}/${result.uuid}`}&gt;
                                    &lt;div  className={clsx(style['搜尋結果框'], '搜尋結果框')} &gt;
                                        &lt;span className={clsx(style['搜尋結果-標題'], '搜尋結果框-標題')} dangerouslySetInnerHTML={{ __html: hightlight(result?.title, searchText, 'span', '高亮', 125) }}&gt;&lt;/span&gt;
                                        &lt;br /&gt;
                                        &lt;p className={clsx(style['搜尋結果-敘述'], '搜尋結果-敘述')} dangerouslySetInnerHTML={{ __html: hightlight(result?.description, searchText, 'span', '高亮', 125) }}&gt;&lt;/p&gt;
                                    &lt;/div&gt;
                                &lt;/a&gt;
                                }
                            
                            &lt;/Fragment&gt;
                        ))
                        }
                    &lt;/Fragment&gt;
                
                }

            &lt;/div&gt;

        &lt;/div&gt;
     


      




    )
};

WebsiteSearchBar.propTypes = {
};

export default WebsiteSearchBar;




</pre>
<h2>src/components/component-instance/WebsiteSearchBar.module.scss</h2>
<pre>// @import &quot;@/assets/scss/my-variables&quot;;



// $props: (
//   width: (
//     name: &quot;width&quot;,
//     default:200px,
//   ),
//   max-width:(
//     name: &quot;max-width&quot;,
//   ),
//   min-width:(
//     name: &quot;min-width&quot;,
//   ),
//   height:(
//     name: &quot;height&quot;,
//   ),
//   max-height:(
//     name: &quot;max-height&quot;,
//   ),
//   min-height:(
//     name: &quot;min-height&quot;,
    
//   ),

// );
// div:has(.搜尋結果-下拉){
//     position: relative;
// }

.站內搜尋框 {
    // @include generate-rwd-stylesheet($props);
    position: relative;
    // width: 100%;
    // max-width: 400px;
    display: flex;
    align-items: center;
    gap: 8px;
}
.搜尋-輸入 {
    flex: 1;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    outline: none;
    transition: border-color 0.3s;
}
.搜尋-輸入:focus {
    border-color: #007bff;
}
.搜尋-按鈕 {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
}
.搜尋-按鈕:hover {
    background-color: #0056b3;
}
.搜尋結果-下拉 {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: white;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    border-radius: 6px;
    z-index: 10;
    max-height: 300px;
    overflow-y: auto;
    padding: 12px;
}
.搜尋結果-下拉.顯示 {
    display: block;
}
.旋轉器框 {
    display: flex;
    justify-content: center;
    padding: 10px;
}
.旋轉器 {
    width: 24px;
    height: 24px;
}
.搜尋結果框 {
    padding: 10px;
    border-bottom: 1px solid #ddd;
    cursor: pointer;
    transition: background 0.3s;
}
.搜尋結果框:hover {
    background: #f8f9fa;
}
.搜尋結果-標題 {
    font-weight: bold;
    font-size: 14px;
    color: #333;
}
.搜尋結果-敘述 {
    font-size: 12px;
    color: #666;
    margin: 4px 0 0;
}
.高亮{color: red;}






// .站內搜尋框{
//     @include generate-rwd-stylesheet($props);
//     position: relative;
// }

// .搜尋-輸入{}
// .搜尋-按鈕{}

// .搜尋結果-下拉{
//     background-color: white;
//     overflow: hidden;
//     position: absolute;
//     top: 100%;
//     left: 50%;
//     transform: translateX(-50%);
//     transition: height 0.3s ease;
//     height: 0px;
//     &amp;.顯示{
//         height: fit-content;
//     }
// }
// .旋轉器框{}
// .旋轉器{}

// .搜尋結果框{}
// .搜尋結果-標題{}
// .搜尋結果-敘述{}

// .高亮{color: red;}
// .website-search-bar{


//     position: relative;
    
//     .search-bar{
        
        
//         @media only screen and (min-width: 1536px){
//             input{
//                 width:var(--width-xxl, none);
//                 max-width: var(--max-width-xxl);
//                 min-width: var(--min-width-xxl);
//                 height:var(--height-xxl, none);
//                 max-height: var(--max-height-xxl);
//                 min-height: var(--min-height-xxl);
//             }
//             input,button&gt;i{
//                 line-height: var(--line-height-xxl);
//                 font-size: var(--font-size-xxl);
//             }
           
          
//         }
//         @media only screen and (min-width: 1280px) and (max-width: 1535px){
//             input{
//                 width:var(--width-xl, none);
//                 max-width: var(--max-width-xl);
//                 min-width: var(--min-width-xl);
//                 height:var(--height-xl, none);
//                 max-height: var(--max-height-xl);
//                 min-height: var(--min-height-xl);
//             }
//             input,button&gt;i{
//                 line-height: var(--line-height-xl);
//                 font-size: var(--font-size-xl);
//             }
          
           
//         }
//         @media only screen and (min-width: 1024px) and (max-width: 1279px){
//             input{
//                 width:var(--width-lg, none);
//                 max-width: var(--max-width-lg);
//                 min-width: var(--min-width-lg);
//                 height:var(--height-lg, none);
//                 max-height: var(--max-height-lg);
//                 min-height: var(--min-height-lg);
//             }
//             input,button&gt;i{
//                 line-height: var(--line-height-lg);
//                 font-size: var(--font-size-lg);
//             }
            
            
//         }
//         @media only screen and (min-width: 768px) and (max-width: 1023px){
//             input{
//                 width:var(--width-md, none);
//             max-width: var(--max-width-md);
//             min-width: var(--min-width-md);
//             height:var(--height-md, none);
//             max-height: var(--max-height-md);
//             min-height: var(--min-height-md);
//             }
//             input,button&gt;i{
//                 line-height: var(--line-height-md);
//                 font-size: var(--font-size-md);
//             }
            
            
//         }
//         @media only screen and (min-width: 640px) and (max-width: 767px){
//             input{
//                 width:var(--width-sm, none);
//                 max-width: var(--max-width-sm);
//                 min-width: var(--min-width-sm);
//                 height:var(--height-sm, none);
//                 max-height: var(--max-height-sm);
//                 min-height: var(--min-height-sm);
//             }
//             input,button&gt;i{
//                 line-height: var(--line-height-sm);
//                 font-size: var(--font-size-sm);
//             }
            
           
//         }
//         @media only screen and (min-width: 390px) and (max-width: 636px){
//             input{
//                 width:var(--width-xs, none);
//                 max-width: var(--max-width-xs);
//                 min-width: var(--min-width-xs);
//                 height:var(--height-xs, none);
//                 max-height: var(--max-height-xs);
//                 min-height: var(--min-height-xs);
//             }
//             input,button&gt;i{
//                 line-height: var(--line-height-xs);
//                 font-size: var(--font-size-xs);
//             }
           
           
//         }
//         @media only screen and (max-width: 389px){
//             input{
//                 width:var(--width-xxs, none);
//             max-width: var(--max-width-xxs);
//             min-width: var(--min-width-xxs);
//             height:var(--height-xxs, none);
//             max-height: var(--max-height-xxs);
//             min-height: var(--min-height-xxs);
//             }
//             input,button&gt;i{
//                 line-height: var(--line-height-xxs);
//                 font-size: var(--font-size-xxs);
//             }
           
           
//         }


//         input {
//             font-size: 14px;
      
//             height: 43px;
//             width: 200px;
//             padding: 2px 55px 2px 18px;
      
//             color: #000;
//             border: 1px solid #e6e6e6;
//             background: transparent none repeat scroll 0 0;
//           }

//         button {
//             font-size: 20px;
        
//             position: absolute;
//             top: 50%;
//             right: 0;
        
//             padding: 0 15px;
        
//             cursor: pointer;
//             transition: all 0.3s ease 0s;
//             transform: translateY(-50%);
        
//             color: #000;
//             border-width: medium medium medium 1px;
//             border-style: none none none solid;
//             border-color: #a1a5aa;
//             border-image: none;
//             background: transparent none repeat scroll 0 0;
//             &amp;:hover {
//                 color: var(--search-bar-text-color-2);
//             }
//         }




//     }

    

//     .dropdown {
//         position: absolute;
//         z-index: 220;
//         // top: 105%;
//         // right: 0%;

//         visibility: hidden;

//         // width: 125px;
//         min-width: 200px;
//         min-height: 50px;

//         padding: 10px 10px ;

//         transition: all 0.5s ease 0s;
//         // transform: rotateX(90deg);
//         // transform-origin: center top 0;
//         text-align: left;

//         opacity: 0;
//         background: #fff none repeat scroll 0 0;
//         box-shadow: 0 1px 7px -2px rgba(0, 0, 0, 0.3);

//         color: #000;


//         @media only screen and (min-width: 1536px){
//             width:var(--width-xxl);
//             h3,.result&gt;span{
//                 line-height: var(--title-line-height-xxl);
//                 font-size: var(--title-font-size-xxl);
//             }
//             .result&gt;p{
//                 line-height: var(--paragraph-line-height-xxl);
//                 font-size: var(--paragraph-font-size-xxl);
//             }
//         }
//         @media only screen and (min-width: 1280px) and (max-width: 1535px){
//             width:var(--width-xl);
//             h3,.result&gt;span{
//                 line-height: var(--title-line-height-xl);
//                 font-size: var(--title-font-size-xl);
//             }
//             .result&gt;p{
//                 line-height: var(--paragraph-line-height-xl);
//                 font-size: var(--paragraph-font-size-xl);
//             }
//         }
//         @media only screen and (min-width: 1024px) and (max-width: 1279px){
//             width:var(--width-lg);
//             h3,.result&gt;span{
//                 line-height: var(--title-line-height-lg);
//                 font-size: var(--title-font-size-lg);
//             }
//             .result&gt;p{
//                 line-height: var(--paragraph-line-height-lg);
//                 font-size: var(--paragraph-font-size-lg);
//             }
//         }
//         @media only screen and (min-width: 768px) and (max-width: 1023px){
//             width:var(--width-md);
//             h3,.result&gt;span{
//                 line-height: var(--title-line-height-md);
//                 font-size: var(--title-font-size-md);
//             }
//             .result&gt;p{
//                 line-height: var(--paragraph-line-height-md);
//                 font-size: var(--paragraph-font-size-md);
//             }
//         }
//         @media only screen and (min-width: 640px) and (max-width: 767px){
//             width:var(--width-sm);
//             h3,.result&gt;span{
//                 line-height: var(--title-line-height-sm);
//                 font-size: var(--title-font-size-sm);
//             }
//             .result&gt;p{
//                 line-height: var(--paragraph-line-height-sm);
//                 font-size: var(--paragraph-font-size-sm);
//             }
//         }
//         @media only screen and (min-width: 390px) and (max-width: 636px){
//             width:var(--width-xs);
//             h3,.result&gt;span{
//                 line-height: var(--title-line-height-xs);
//                 font-size: var(--title-font-size-xs);
//             }
//             .result&gt;p{
//                 line-height: var(--paragraph-line-height-xs);
//                 font-size: var(--paragraph-font-size-xs);
//             }
//         }
//         @media only screen and (max-width: 389px){
//             width:var(--width-xxs);
//             h3,.result&gt;span{
//                 line-height: var(--title-line-height-xxs);
//                 font-size: var(--title-font-size-xxs);
//             }
//             .result&gt;p{
//                 line-height: var(--paragraph-line-height-xxs);
//                 font-size: var(--paragraph-font-size-xxs);
//             }
            
//         }

//         &amp;.dimension1{
//             top: 100%;
//             right: 0%;
//             transform: rotateX(90deg);

//             transform-origin: center top 0;

//         }

//         &amp;.dimension2{
//             top: 100%;
//             left: 0%;
//             transform: rotateX(90deg);

//             transform-origin: center top 0;

//         }

//         &amp;.dimension3{
//             bottom: 100%;
//             left:0%;
//             transform: rotateX(90deg);

//             transform-origin: center bottom 0;

//         }

//         &amp;.dimension4{
//             bottom: 100%;
//             right: 0%;
//             transform: rotateX(90deg);

//             transform-origin: center bottom 0;

//         }

//         &amp;.active {
//             visibility: visible;

//             transform: rotateX(0deg);

//             opacity: 1;
//         }

        
//         .result{
//             border-bottom: 2px solid gray;

//         }



    
//     }
    
// }</pre>
</body>
</html>